Поддержка тестирования в Go включает в себя две составляющие: библиотеки и инструменты. Пакет testing стандартной библиотеки предоставляет типы и функции для тестов, а встроенная команда go test обеспечивает выполнение тестов и генерирование отчетов. В Go тесты размещаются в одном каталоге и пакете с прикладным кодом. Это позволяет тестам использовать и тестировать неэкспортируемые функции и переменные. Тесты сохраняются в файлах с именами, оканчивающимися на _test.go. Так, если вы пишете тесты для файла foo.go, то поместите их в файл с именем foo_test.go. Имена функций тестирования начинаются со слова Test, они принимают один параметр типа *testing.T , в качестве имени которого принято использовать букву t. Функции тестирования не возвращают никаких значений. Команда go test запускает тесты, расположенные в теку­щем каталоге. Задав в качестве имени пакета выражение ./..., можно запустить тесты, на­ходящиеся в текущем каталоге и всех вложенных подкаталогах. Для получения подробных результатов тестирования используйте эту команду с флагом -v.
Методы Error и Errorf помечают тест как не пройденный, функция тести­рования при этом продолжает работать. Если нужно, чтобы функция тести­рования прекращала свою работу сразу после обнаружения ошибки, используйте методы Fatal и Fatalf, но после выхода из текущей функции тестирования будет продолжено выполнение остальных функций тестирования.
функция TestMain вызывается только один раз, а не до и после каждого отдельного теста. Кроме того, в каждом пакете можно опре­делить только одну функцию TestMain. Функция TestMain может быть полезной в следующих двух распространенных случаях. Когда требуется настроить данные в некотором внешнем хранилище, напри­мер в базе данных. Когда тестируемый код зависит от переменных уровня пакета, которые нужно инициализировать.

Если это возможно, ваши программы не должны содержать переменных уровня пакета. Такие пере­менные затрудняют понимание перемещения данных внутри программы. 

Для высвобождения временных ресурсов, выделенных для отдельного теста, сле­дует вызвать метод Cleanup экземпляра типа *testing.T. Этот метод принимает функцию без входных параметров и возвращаемых значений, которая выполня­ется по завершении теста. Многократные вызовы метода Cleanup обрабаты­ ваются в порядке, обратном порядку их добавления.

Использование переменных окружения для настройки приложения считается хорошей практикой, но нелишне также убедиться, что большая часть кода вообще не знает о них. Всегда копируйте значения переменных окружения
в структуры с конфигурационными параметрами в функции main до того, как программа начнет работу, или вскоре после этого. Такое абстрагирова­ние конфигурации от прикладной логики упростит повторное применение
и тестирование кода.

Если для тестирования функций в пакете требуется применять образцы данных, то создайте для хранения файлов с данными подкаталог с именем testdata. Go резервирует это имя каталога для
размещения тестовых файлов. При чтении данных из каталога testdata всегда используйте относительные ссылки на файлы. Поскольку команда go test при­меняет в качестве текущего рабочего каталога каталог текущего пакета, каждый пакет обращается по относительному пути к собственному каталогу testdata.

Чтобы протестировать только публичный API пакета, можно воспользоваться общепринятым в Go соглашением: исходный код теста все так же сохранить в одном каталоге с прикладным кодом, но в качестве имени пакета указать имя имяПакета_test (например package pubadder_test и внутри вызывать pubadder.AddNumbers(2, 3) на и внутри теста нужно импортировать пакет, несмотря на то, что он находится в одном каталоге).

Использование имени пакета с суффиксом _test позволяет превратить пакет в своего рода черный ящик и ограничить взаимодействие с ним только через экспортируемые функции, методы, типы, константы и переменные.
Имейте в виду, что в одном и том же каталоге с исходным кодом могут присут­ ствовать файлы тестов, применяющие оба имени пакета.
